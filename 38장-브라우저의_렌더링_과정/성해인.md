# 38. 브라우저의 렌더링 과정

> ***파싱(parsing)***
> ***
> * = 구문 분석(syntax analysis)
> * text 문자열을 token으로 분해(어휘 분석lesical analysis)한 뒤, 문법적 의미와 구조를 반영하여 토큰에 parse tree/syntax tree를 생성하는 일련의 과정
> * 일반적으로 parsing이 완료된 이후에는 parse tree를 기반으로 중간 언어(intermediate code)인 bytecode를 생성하고 실행

> ***렌더링(rendering)***
> ***
> HTML, CSS, Javascript로 작성된 문서를 parsing하여 browser에 시각적으로 출력하는 것
> * 브라우저 시각화를 위한 parsing의 일종?

<br>

#### 브라우저의 렌더링 과정(critical rendering path)
<img src="shi_images\img.png" width="100%">

1. 브라우저가 렌더링에 필요한 리소스를 서버에 요청하고 응답을 받음
   * 렌더링에 필요한 resource: HTML, CSS, Javascript, image file(s), font file(s), etc...
2. 브라우저 렌더링 엔진은 서버에서 response로 받은 HTML과 CSS를 parsing하여 DOM, CSSOM을 생성한 뒤 이들을 결합하여 렌더 트리를 생성
3. 브라우저 Javascript engine은 서버에서 응답받은 javascript를 parsing하여 Abstract Syntax Tree를 생성한 뒤 바이트코드로 변환하여 실행함. 자바스크립트는 DOM API를 통해 DOM/CSSOM을 변경할 수 있고, 변경된 DOM과 CSSOM은 다시 render tree로 결합됨
4. render tree를 기반으로 HTML 요소의 layout을 계산한 뒤 browser 화면에 HTML 요소를 painting함
   * 레이아웃(layout): 위치와 크기

<br>

## 38.1 요청과 응답

> 브라우저의 핵심 기능
> ***
> 필요한 resource를 server에 request하고 server에서 받은 response를 browser에 시각적으로 rendering하는 것
> * rendering에 필요한 resource는 모두 server에 존재함 <br>☞ 그러므로 필요한 resource를 server에 요청하고 응답한 resource를 parsing하여 rendering하는 것

<br>

#### 서버에 요청을 전송하기 위해 식별용 *주소*가 필요 → 브라우저는 주소창 제공
<figure>
<img src="shi_images\img_1.png" width="100%">
<figcaption>URI: Uniform Resource Identifier</figcaption>
</figure>
1. 브라우저의 주소창에 URL 입력
2. 엔터 키 누름
3. URL host name이 DNS를 통해 IP주소로 변환
4. 해당 IP주소를 갖는 server에게 요청을 전송함

<br>

##### (예시) 브라우저의 주소창에 https://poiemaweb.com 을 입력하고 엔터 키를 누른다면? 

1. 루트 요청이 poiemaweb.com 서버로 전송됨
   * 루트 요청: /, scheme과 host만으로 구성된 URI에 의한 요청
2. 명확한 resource를 요청하는 내용이 없으면 암묵적으로(default) index.html(https://poiemaweb.com/index.html) 응답
3. 명확한 resource를 요청하려면 브라우저의 주소창에 요청할 정적 파일의 경로와 파일 이름을 URI 호스트 뒤의 path에 기술하여 서버에 요청
   * (예) https://poiemaweb.com URI host 뒤에 /assets/data/data.json path와 파일 이름까지 기술<br>이 경우엔 aseets/data 폴더 내에 있는 정적 파일 data.json 응답할 것

<br>

#### 비단 주소창뿐만이 아니라 자바스크립트를 통해 동적으로 서버에 정적/동적 데이터를 요청하는 것도 가능

<br>

#### 요청과 응답은 개발자 도구의 Network 패널에서 확인 가능

1. 브라우저의 주소창에 https://poiemaweb.com 입력
2. 엔터 키를 눌러서 서버에 루트 요청 전송
3. 브라우저가 poiemaweb.com 서버에 요청한 내용, 서버가 응답한 내용을 개발자 도구 Network 패널에서 확인 가능
   * 개발자 도구 Network 패널을 활성화하기 전에 브라우저가 이미 응답을 받았다면 응답된 리소스가 표시되지 않음<br>이 경우엔 페이지를 새로고침해야 Network 패널에서 request, response내역 확인 가능
4. response엔 HTML뿐만 아니라 CSS, Javascript, image file, font file 등도 포함
   * 브라우저 렌더링 엔진이 HTML(index.html)를 parsing하는 도중에 각종 태그들을 만나면 HTML parsing을 일시 중단하고 해당 tag에서 가리키는 resource file을 서버로 요청
   <img src="shi_images\img_2.png" width="100%">

<br>

## 38.2 HTTP 1.1과 HTTP 2.0

<br>

## 38.3 HTML 파싱과 DOM 생성

<br>

## 38.4 CSS 파싱과 CSSOM 생성

<br>

## 38.5 렌더 트리 생성

<br>

## 38.6 자바스크립트 파싱과 실행

<br>

## 38.7 리플로우와 리페인트

<br>

## 38.8 자바스크립트 파싱에 의한 HTML 파싱 중단

<br>

## 38.9 script 태그의 async/defer 어트리뷰트

<br>
